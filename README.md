# Audio Loss Checker

ä¸€ä¸ªç®€å•çš„CLIå·¥å…·ï¼Œç”¨äºæ£€æµ‹æ— æŸéŸ³é¢‘æ–‡ä»¶æ˜¯å¦çœŸçš„æ˜¯æ— æŸæ ¼å¼ã€‚

## æ”¯æŒæ ¼å¼
- **WAV** - WindowséŸ³é¢‘æ–‡ä»¶ âœ…
- **FLAC** - è‡ªç”±æ— æŸéŸ³é¢‘ç¼–è§£ç å™¨ âœ…
- **ALAC** - Appleæ— æŸéŸ³é¢‘ç¼–è§£ç å™¨ ğŸš§ (å¼€å‘ä¸­)
- **APE** - Monkey's Audio ğŸš§ (å¼€å‘ä¸­)

## å‘½ä»¤è¡Œå‚æ•°

### 1. è¾“å‡ºæ§åˆ¶ (Output Control)

#### `-q, --quiet`
é™é»˜æ¨¡å¼ï¼Œä»…è¾“å‡ºè¢«åˆ¤å®šä¸º"å‡æ— æŸ"çš„æ–‡ä»¶è·¯å¾„ï¼Œæ¯è¡Œä¸€ä¸ªã€‚

```bash
# æ‰«ææ•´ä¸ªç›®å½•ï¼Œåªåˆ—å‡ºæœ‰é—®é¢˜çš„æ–‡ä»¶è·¯å¾„
./audio-loss-checker --quiet /mnt/music

# ç¤ºä¾‹è¾“å‡º:
# /mnt/music/album1/track01.flac
# /mnt/music/album3/track05.flac
```

#### `--only-fake`
åªæ˜¾ç¤ºè¢«åˆ¤å®šä¸º"å‡æ— æŸ"æ–‡ä»¶çš„å®Œæ•´åˆ†ææŠ¥å‘Šã€‚

```bash
# æ‰«æç›®å½•ï¼Œå¹¶è¯¦ç»†æ˜¾ç¤ºæ¯ä¸ªå¯ç–‘æ–‡ä»¶çš„ä¿¡æ¯
./audio-loss-checker --only-fake /mnt/music
```

#### `--json`
ä»¥JSONæ ¼å¼è¾“å‡ºæ‰€æœ‰æ–‡ä»¶çš„åˆ†æç»“æœã€‚

```bash
# ä»¥JSONæ ¼å¼æ‰«æç›®å½•ï¼Œå¹¶å°†ç»“æœé‡å®šå‘åˆ°æ–‡ä»¶
./audio-loss-checker --json /mnt/music > analysis_result.json
```

**JSONè¾“å‡ºç¤ºä¾‹:**
```json
{
  "filePath": "/mnt/music/real.flac",
  "format": "FLAC",
  "metadata": { "title": "Real Song", "artist": "Good Artist" },
  "status": "OK",
  "analysis": { "isFake": false, "details": "é¢‘è°±æ­£å¸¸ï¼Œå¯èƒ½æ˜¯çœŸå®çš„æ— æŸéŸ³ä¹" }
}
{
  "filePath": "/mnt/music/fake.flac",
  "format": "FLAC",
  "metadata": { "title": "Fake Song", "artist": "Bad Converter" },
  "status": "FAKE",
  "analysis": { "isFake": true, "cutoffHz": 16054, "details": "åœ¨ 16054 Hz é™„è¿‘æœ‰æ˜æ˜¾æˆªæ–­" }
}
```

### 2. åˆ†æè°ƒæ•´ (Analysis Tuning)

#### `--cutoff <frequency>`
è®¾ç½®è‡ªå®šä¹‰çš„é¢‘ç‡æˆªæ–­é˜ˆå€¼ï¼ˆå•ä½Hzï¼‰ã€‚å¦‚æœæ£€æµ‹åˆ°çš„é¢‘è°±æœ€é«˜æœ‰æ•ˆé¢‘ç‡ä½äºæ­¤å€¼ï¼Œåˆ™åˆ¤å®šä¸ºå‡æ— æŸã€‚

```bash
# ä½¿ç”¨æ›´ä¸¥æ ¼çš„19kHzä½œä¸ºåˆ¤æ–­æ ‡å‡†
./audio-loss-checker --cutoff 19000 /path/to/file.flac

# ä½¿ç”¨æ›´å®½æ¾çš„17kHzæ ‡å‡†ï¼Œç”¨äºæ’æŸ¥ä¸€äº›ä½è´¨é‡å½•éŸ³
./audio-loss-checker --cutoff 17000 /path/to/file.flac
```

### 3. æ€§èƒ½ä¸é€šç”¨é€‰é¡¹ (Performance & General)

#### `-j <number>, --concurrency <number>`
è®¾ç½®å¹¶å‘å¤„ç†æ–‡ä»¶çš„æ•°é‡ï¼Œå¯ä»¥æ˜¾è‘—åŠ å¿«æ‰«æå¤§å‹ç›®å½•çš„é€Ÿåº¦ã€‚

```bash
# ä½¿ç”¨8ä¸ªå¹¶å‘ä»»åŠ¡æ‰«æç›®å½•
./audio-loss-checker -j 8 /mnt/huge_music_library
```

#### `-v, --version`
æ˜¾ç¤ºç¨‹åºç‰ˆæœ¬ã€‚

```bash
./audio-loss-checker --version
# è¾“å‡º: audio-loss-checker version 1.1.0
```

#### `-h, --help`
æ˜¾ç¤ºå¸®åŠ©èœå•ï¼Œåˆ—å‡ºæ‰€æœ‰å¯ç”¨å‘½ä»¤å’Œé€‰é¡¹ã€‚

```bash
./audio-loss-checker --help
```

## ä½¿ç”¨ç¤ºä¾‹

### ç»„åˆå‚æ•°ä½¿ç”¨
**åœºæ™¯:** å¿«é€Ÿæ‰«æå¤§å‹éŸ³ä¹åº“ï¼ŒæŸ¥æ‰¾å¯ç–‘çš„"å‡æ— æŸ"æ–‡ä»¶

å‡è®¾ä½ æƒ³è¦ï¼š
- ä½¿ç”¨4ä¸ªCPUæ ¸å¿ƒè¿›è¡Œå¹¶å‘æ‰«æä»¥èŠ‚çœæ—¶é—´
- åªå…³å¿ƒé‚£äº›æœ‰é—®é¢˜çš„"å‡æ— æŸ"æ–‡ä»¶
- å°†å®Œæ•´æŠ¥å‘Šä¿å­˜åˆ°æ—¥å¿—æ–‡ä»¶ä¸­ä¾›æ—¥åæŸ¥çœ‹

```bash
./audio-loss-checker --only-fake -j 4 /mnt/nas/music > suspicious_files_report.txt
```

è¿™ä¸ªå‘½ä»¤ä¼šé«˜æ•ˆåœ°å®Œæˆæ‰«æï¼Œå¹¶å°†æ‰€æœ‰å¯ç–‘æ–‡ä»¶çš„è¯¦ç»†åˆ†æä¿å­˜åœ¨ `suspicious_files_report.txt` æ–‡ä»¶ä¸­ã€‚

## å®‰è£…ä¸ç¼–è¯‘

### é¢„ç¼–è¯‘ç‰ˆæœ¬
ä» [Releases](../../releases) é¡µé¢ä¸‹è½½é€‚åˆä½ æ“ä½œç³»ç»Ÿçš„é¢„ç¼–è¯‘ç‰ˆæœ¬ã€‚

### ä»æºç ç¼–è¯‘

#### å‰ç½®è¦æ±‚
- Go 1.24+ 

#### ç¼–è¯‘æ­¥éª¤
```bash
# å…‹éš†ä»“åº“
git clone https://github.com/your-username/audio-loss-checker.git
cd audio-loss-checker

# ä½¿ç”¨ Makefile ç¼–è¯‘ï¼ˆæ¨èï¼‰
make help          # æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤
make build         # ç¼–è¯‘å½“å‰å¹³å°ç‰ˆæœ¬
make build-all     # ç¼–è¯‘æ‰€æœ‰å¹³å°ç‰ˆæœ¬
make install       # å®‰è£…åˆ°ç³»ç»Ÿ

# æˆ–è€…ç›´æ¥ä½¿ç”¨ Go å‘½ä»¤
go mod tidy
go build -o audio-loss-checker
```

#### Makefile å‘½ä»¤è¯´æ˜
```bash
make build          # ç¼–è¯‘å½“å‰å¹³å°ç‰ˆæœ¬
make build-all      # ç¼–è¯‘æ‰€æœ‰å¹³å°ç‰ˆæœ¬ (Windows/Linux/macOS)
make build-windows  # ä»…ç¼–è¯‘ Windows ç‰ˆæœ¬
make build-linux    # ä»…ç¼–è¯‘ Linux ç‰ˆæœ¬  
make build-darwin   # ä»…ç¼–è¯‘ macOS ç‰ˆæœ¬
make clean          # æ¸…ç†æ„å»ºæ–‡ä»¶
make test           # è¿è¡Œæµ‹è¯•
make fmt            # æ ¼å¼åŒ–ä»£ç 
make install        # å®‰è£…åˆ°ç³»ç»Ÿ
make release        # åˆ›å»ºå‘å¸ƒåŒ…
```

## æŠ€æœ¯åŸç†

### æ£€æµ‹æ–¹æ³•
1. **FFTé¢‘è°±åˆ†æ**: å¯¹éŸ³é¢‘è¿›è¡Œå¿«é€Ÿå‚…é‡Œå¶å˜æ¢
2. **é«˜é¢‘æˆªæ–­æ£€æµ‹**: è¯†åˆ«äººå·¥æˆªæ–­çš„é¢‘ç‡è¾¹ç•Œ
3. **æ¨¡å¼åŒ¹é…**: å¯¹æ¯”å·²çŸ¥æœ‰æŸç¼–ç çš„é¢‘è°±ç‰¹å¾
4. **é˜ˆå€¼åˆ¤æ–­**: åŸºäºç”¨æˆ·è®¾å®šæˆ–é»˜è®¤é˜ˆå€¼è¿›è¡Œåˆ¤æ–­

> ğŸ“– è¯¦ç»†æŠ€æœ¯åŸç†è¯·å‚è€ƒ [TECHNICAL.md](TECHNICAL.md)

### æ”¯æŒæ ¼å¼
- âœ… **WAV**: å®Œå…¨æ”¯æŒ
- âœ… **FLAC**: å®Œå…¨æ”¯æŒï¼ŒåŒ…æ‹¬å…ƒæ•°æ®è§£æ
- ğŸš§ **ALAC**: åŸºç¡€æ”¯æŒï¼ˆå¼€å‘ä¸­ï¼‰
- ğŸš§ **APE**: åŸºç¡€æ”¯æŒï¼ˆå¼€å‘ä¸­ï¼‰

### æ£€æµ‹å‡†ç¡®æ€§
- **é«˜å‡†ç¡®æ€§**: MP3è½¬æ¢çš„FLACæ–‡ä»¶ï¼ˆå…¸å‹æˆªæ–­æ¨¡å¼ï¼‰
- **ä¸­ç­‰å‡†ç¡®æ€§**: å…¶ä»–æœ‰æŸæ ¼å¼è½¬æ¢çš„æ–‡ä»¶
- **æ³¨æ„**: æŸäº›é«˜è´¨é‡å½•éŸ³å¯èƒ½è¢«è¯¯åˆ¤ï¼Œå»ºè®®ç»“åˆå¬æ„Ÿåˆ¤æ–­

## å¼€å‘

### é¡¹ç›®ç»“æ„
```
audio-loss-checker/
â”œâ”€â”€ cmd/                    # CLIå‘½ä»¤å®šä¹‰
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ analyzer/          # éŸ³é¢‘åˆ†æå™¨
â”‚   â”œâ”€â”€ decoder/           # éŸ³é¢‘è§£ç å™¨
â”‚   â””â”€â”€ types/             # ç±»å‹å®šä¹‰
â”œâ”€â”€ examples.md            # ä½¿ç”¨ç¤ºä¾‹
â”œâ”€â”€ TECHNICAL.md           # æŠ€æœ¯åŸç†æ–‡æ¡£
â”œâ”€â”€ Makefile              # è·¨å¹³å°æ„å»ºè„šæœ¬
â””â”€â”€ README.md
```

### è´¡çŒ®
æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

## è®¸å¯è¯
æœ¬é¡¹ç›®é‡‡ç”¨ [LICENSE](LICENSE) è®¸å¯è¯ã€‚
